{"ast":null,"code":"import React from'react';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const EvaluationCard=_ref=>{let{student={}}=_ref;const navigate=useNavigate();const{student_id,student_name='-',profile_image,supervisor_name='-',company_name='-',supervisor_score:supRaw,// 0–100 (null ถ้ายังไม่กรอก)\ncompany_score:compRaw,// ดิบ 0–120 (null ถ้ายังไม่กรอก)\ncompany_score_pct,// 0–100 (อาจไม่มีจาก API)\nfinal_score// 0–100 (อาจไม่มีจาก API)\n// final_status   // ไม่ใช้ตัดสิน เพื่อกันกรณีฝั่งหนึ่งยังไม่ได้กรอก\n}=student||{};// --- Helpers ---\nconst toNum=v=>v===null||v===undefined||isNaN(Number(v))?null:Number(v);const clamp=(v,min,max)=>v==null?null:Math.max(min,Math.min(max,v));const fmt=function(v){let d=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;return v==null||Number.isNaN(+v)?'-':Number(v).toFixed(d);};// --- Normalize values ---\nconst sup=clamp(toNum(supRaw),0,100);// 0..100 or null\nconst comp120=clamp(toNum(compRaw),0,120);// 0..120 or null\nconst compPct=toNum(company_score_pct)!=null?clamp(Number(company_score_pct),0,100):comp120!=null?comp120/120*100:null;// --- Final score (เฉพาะเมื่อมีคะแนนทั้งสองฝั่ง) ---\nconst bothProvided=sup!=null&&sup>0&&// ✅ เปลี่ยน > 0 เป็น sup != null ถ้าต้องการนับ 0 ว่า “กรอกแล้ว”\ncomp120!=null&&comp120>0;// ✅ เช่นเดียวกัน: comp120 != null เพื่อให้นับ 0 เป็นกรอกแล้ว\nconst computedFinal=sup!=null&&compPct!=null?compPct*0.6+sup*0.4:null;const fScore=bothProvided&&toNum(final_score)!=null?Number(final_score):bothProvided?computedFinal:null;// --- Status ---\nlet status='pending';if(bothProvided)status=fScore>=70?'pass':'fail';const badge={pass:{text:'ผ่าน',cls:'bg-green-500 text-white'},fail:{text:'ไม่ผ่าน',cls:'bg-red-500 text-white'},pending:{text:'รอคะแนนครบ',cls:'bg-gray-400 text-white'}}[status];const handleDetailClick=()=>{navigate(`/student-detail/${student_id}`);};const imgSrc=`http://localhost:5000/uploads/${profile_image||'default.jpg'}`;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-lg border border-blue-200 p-5 mb-5 flex flex-col md:flex-row md:items-center gap-6 text-black\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-5 items-start\",children:[/*#__PURE__*/_jsx(\"img\",{src:imgSrc,alt:\"profile\",className:\"w-24 h-24 rounded-full object-cover border-4 border-indigo-300\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-xl\",children:student_name}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDetailClick,className:\"text-blue-600 text-sm underline hover:text-blue-800\",children:\"\\u0E14\\u0E39\\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E40\\u0E15\\u0E34\\u0E21\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 space-y-1\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0E2D\\u0E32\\u0E08\\u0E32\\u0E23\\u0E22\\u0E4C\\u0E19\\u0E34\\u0E40\\u0E17\\u0E28 40% : \",supervisor_name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0E04\\u0E30\\u0E41\\u0E19\\u0E19\\u0E17\\u0E35\\u0E48\\u0E44\\u0E14\\u0E49 : \",fmt(sup,0),\" / 100 \\u0E04\\u0E30\\u0E41\\u0E19\\u0E19\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-2\",children:[\"\\u0E2A\\u0E16\\u0E32\\u0E19\\u0E1B\\u0E23\\u0E30\\u0E01\\u0E2D\\u0E1A\\u0E01\\u0E32\\u0E23 60% : \",company_name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0E04\\u0E30\\u0E41\\u0E19\\u0E19\\u0E17\\u0E35\\u0E48\\u0E44\\u0E14\\u0E49 : \",fmt(comp120,0),\" / 120 \\u0E04\\u0E30\\u0E41\\u0E19\\u0E19\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-2 font-medium\",children:[\"\\u0E2A\\u0E23\\u0E38\\u0E1B\\u0E23\\u0E27\\u0E21 (\\u0E40\\u0E01\\u0E13\\u0E11\\u0E4C\\u0E1C\\u0E48\\u0E32\\u0E19 \\u2265 70%) : \",fScore==null?'-':`${fmt(fScore,1)}%`]})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-auto\",children:/*#__PURE__*/_jsx(\"span\",{className:`px-4 py-2 rounded font-medium ${badge.cls}`,children:badge.text})})]});};export default EvaluationCard;","map":{"version":3,"names":["React","useNavigate","jsx","_jsx","jsxs","_jsxs","EvaluationCard","_ref","student","navigate","student_id","student_name","profile_image","supervisor_name","company_name","supervisor_score","supRaw","company_score","compRaw","company_score_pct","final_score","toNum","v","undefined","isNaN","Number","clamp","min","max","Math","fmt","d","arguments","length","toFixed","sup","comp120","compPct","bothProvided","computedFinal","fScore","status","badge","pass","text","cls","fail","pending","handleDetailClick","imgSrc","className","children","src","alt","onClick"],"sources":["D:/New folder/internconnect/frontend/src/components/EvaluationCard.js"],"sourcesContent":["import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst EvaluationCard = ({ student = {} }) => {\r\n  const navigate = useNavigate();\r\n\r\n  const {\r\n    student_id,\r\n    student_name = '-',\r\n    profile_image,\r\n    supervisor_name = '-',\r\n    company_name = '-',\r\n    supervisor_score: supRaw,   // 0–100 (null ถ้ายังไม่กรอก)\r\n    company_score: compRaw,     // ดิบ 0–120 (null ถ้ายังไม่กรอก)\r\n    company_score_pct,          // 0–100 (อาจไม่มีจาก API)\r\n    final_score,                // 0–100 (อาจไม่มีจาก API)\r\n    // final_status   // ไม่ใช้ตัดสิน เพื่อกันกรณีฝั่งหนึ่งยังไม่ได้กรอก\r\n  } = student || {};\r\n\r\n  // --- Helpers ---\r\n  const toNum = (v) => (v === null || v === undefined || isNaN(Number(v)) ? null : Number(v));\r\n  const clamp = (v, min, max) => (v == null ? null : Math.max(min, Math.min(max, v)));\r\n  const fmt = (v, d = 1) => (v == null || Number.isNaN(+v) ? '-' : Number(v).toFixed(d));\r\n\r\n  // --- Normalize values ---\r\n  const sup = clamp(toNum(supRaw), 0, 100);      // 0..100 or null\r\n  const comp120 = clamp(toNum(compRaw), 0, 120); // 0..120 or null\r\n  const compPct =\r\n    toNum(company_score_pct) != null\r\n      ? clamp(Number(company_score_pct), 0, 100)\r\n      : comp120 != null\r\n        ? (comp120 / 120) * 100\r\n        : null;\r\n\r\n  // --- Final score (เฉพาะเมื่อมีคะแนนทั้งสองฝั่ง) ---\r\n  const bothProvided =\r\n    (sup != null && sup > 0) &&           // ✅ เปลี่ยน > 0 เป็น sup != null ถ้าต้องการนับ 0 ว่า “กรอกแล้ว”\r\n    (comp120 != null && comp120 > 0);     // ✅ เช่นเดียวกัน: comp120 != null เพื่อให้นับ 0 เป็นกรอกแล้ว\r\n\r\n  const computedFinal = (sup != null && compPct != null)\r\n    ? compPct * 0.6 + sup * 0.4\r\n    : null;\r\n\r\n  const fScore = (bothProvided && toNum(final_score) != null)\r\n    ? Number(final_score)\r\n    : (bothProvided ? computedFinal : null);\r\n\r\n  // --- Status ---\r\n  let status = 'pending';\r\n  if (bothProvided) status = (fScore >= 70 ? 'pass' : 'fail');\r\n\r\n  const badge = {\r\n    pass:   { text: 'ผ่าน',        cls: 'bg-green-500 text-white' },\r\n    fail:   { text: 'ไม่ผ่าน',     cls: 'bg-red-500 text-white' },\r\n    pending:{ text: 'รอคะแนนครบ', cls: 'bg-gray-400 text-white' },\r\n  }[status];\r\n\r\n  const handleDetailClick = () => {\r\n    navigate(`/student-detail/${student_id}`);\r\n  };\r\n\r\n  const imgSrc = `http://localhost:5000/uploads/${profile_image || 'default.jpg'}`;\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-xl shadow-lg border border-blue-200 p-5 mb-5 flex flex-col md:flex-row md:items-center gap-6 text-black\">\r\n      <div className=\"flex gap-5 items-start\">\r\n        <img\r\n          src={imgSrc}\r\n          alt=\"profile\"\r\n          className=\"w-24 h-24 rounded-full object-cover border-4 border-indigo-300\"\r\n        />\r\n        <div>\r\n          <h3 className=\"font-semibold text-xl\">{student_name}</h3>\r\n\r\n          <button\r\n            onClick={handleDetailClick}\r\n            className=\"text-blue-600 text-sm underline hover:text-blue-800\"\r\n          >\r\n            ดูข้อมูลเพิ่มเติม\r\n          </button>\r\n\r\n          <div className=\"mt-3 space-y-1\">\r\n            <p>อาจารย์นิเทศ 40% : {supervisor_name}</p>\r\n            <p>คะแนนที่ได้ : {fmt(sup, 0)} / 100 คะแนน</p>\r\n            <p className=\"mt-2\">สถานประกอบการ 60% : {company_name}</p>\r\n            <p>คะแนนที่ได้ : {fmt(comp120, 0)} / 120 คะแนน</p>\r\n            <p className=\"mt-2 font-medium\">\r\n              สรุปรวม (เกณฑ์ผ่าน ≥ 70%) : {fScore == null ? '-' : `${fmt(fScore, 1)}%`} \r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* ตำแหน่งเดิมของดรอปดาว → แสดง Badge */}\r\n      <div className=\"ml-auto\">\r\n        <span className={`px-4 py-2 rounded font-medium ${badge.cls}`}>\r\n          {badge.text}\r\n        </span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EvaluationCard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}